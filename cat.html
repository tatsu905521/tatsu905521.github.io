<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>小貓吃食物遊戲</title>
<style>
    body {
        margin: 0;
        overflow: hidden;
        background: #fcefe6;
    }
    canvas {
        display: block;
        margin: 0 auto;
        background: #fff7f0;
    }
</style>
</head>
<body>

<canvas id="gameCanvas"></canvas>

<script>
// === 遊戲畫布 ===
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

// 手機直向為主，但電腦也能玩
function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
window.addEventListener("resize", resize);
resize();

// === 小貓設定 ===
const catImg = new Image();
catImg.src = "61ba6fdc-045c-4615-9b98-ba21901e27f1.png
";  // ← 你的小貓圖片放這

let cat = {
    x: canvas.width / 2,
    y: canvas.height - 150,
    size: 120,
    speed: 15 // ← 已加快
};

// === 遊戲狀態 ===
let score = 0;
let life = 1; // ← 生命一次
let foodList = [];
let foodSpeed = 3; // 初始速度
let spawnRate = 20; // 食物密度（數字越小越密）
let frame = 0;

// === 生成食物 ===
function spawnFood() {
    const isGood = Math.random() > 0.35;
    foodList.push({
        x: Math.random() * (canvas.width - 40),
        y: -40,
        size: 50,
        speed: foodSpeed,
        good: isGood
    });
}

// === 食物繪製 ===
function drawFood() {
    for (let f of foodList) {
        ctx.fillStyle = f.good ? "#ff7eb3" : "#444";
        ctx.beginPath();
        ctx.arc(f.x, f.y, f.size/2, 0, Math.PI * 2);
        ctx.fill();
    }
}

// === 移動 + 碰撞 ===
function updateFood() {
    for (let i = foodList.length - 1; i >= 0; i--) {
        let f = foodList[i];
        f.y += f.speed;

        // 碰到小貓
        if (Math.abs(f.x - cat.x) < cat.size/2 &&
            Math.abs(f.y - cat.y) < cat.size/2) {

            if (f.good) {
                score += 100;
            } else {
                life -= 1;
            }
            foodList.splice(i, 1);
            continue;
        }

        // 超出畫面移除
        if (f.y > canvas.height + 50) {
            foodList.splice(i, 1);
        }
    }
}

// === 小貓繪製 ===
function drawCat() {
    ctx.drawImage(catImg, cat.x - cat.size/2, cat.y - cat.size/2, cat.size, cat.size);
}

// === UI ===
function drawUI() {
    ctx.fillStyle = "#333";
    ctx.font = "28px sans-serif";
    ctx.fillText("分數: " + score, 20, 40);
    ctx.fillText("生命: " + life, 20, 80);
}

// === 主迴圈 ===
function gameLoop() {
    if (life <= 0) {
        ctx.fillStyle = "#000";
        ctx.font = "50px sans-serif";
        ctx.fillText("遊戲結束！分數：" + score, canvas.width/2 - 150, canvas.height/2);
        return;
    }

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // 每 15 frame 掉落一次
    if (frame % spawnRate === 0) {
        spawnFood();
    }

    // 加速
    if (frame % 300 === 0) {
        foodSpeed += 0.4;
        cat.speed += 1;
        if (spawnRate > 8) spawnRate -= 1;
    }

    updateFood();
    drawFood();
    drawCat();
    drawUI();

    frame++;
    requestAnimationFrame(gameLoop);
}
requestAnimationFrame(gameLoop);

// === 電腦鍵盤控制 ===
document.addEventListener("keydown", e => {
    if (e.key === "ArrowLeft") cat.x -= cat.speed;
    if (e.key === "ArrowRight") cat.x += cat.speed;
});

// === 手機觸控控制 ===
document.addEventListener("touchmove", e => {
    cat.x = e.touches[0].clientX;
});
</script>

</body>
</html>
