<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>小貓接食物遊戲</title>
<style>
    html, body {
        margin: 0;
        padding: 0;
        overflow: hidden;
        height: 100%;
        background: #f8f3ff;
        font-family: Arial, sans-serif;
        user-select: none;
    }

    canvas {
        display: block;
        background: linear-gradient(#fcefff, #e6d7ff);
    }

    #ui {
        position: fixed;
        top: 10px;
        left: 50%;
        transform: translateX(-50%);
        color: #333;
        font-size: 24px;
        font-weight: bold;
        text-shadow: 0 0 5px #fff;
    }
</style>
</head>
<body>

<div id="ui">分數：0　|　生命：3</div>
<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

// --------- 全螢幕尺寸設定 ---------
function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
resize();
window.addEventListener("resize", resize);

// --------- 小貓設定 ---------
const cat = {
    x: canvas.width / 2,
    y: canvas.height - 120,
    size: 80,
    speed: 15
};

// --------- 遊戲資料 ---------
let score = 0;
let life = 3;
let foods = [];
let fallSpeed = 3;
let frameCount = 0;

// --------- 食物生成 ---------
function spawnFood() {
    const isGood = Math.random() < 0.7; // 70% 甜食
    foods.push({
        x: Math.random() * (canvas.width - 50),
        y: -50,
        size: 50,
        speed: fallSpeed,
        good: isGood
    });
}

// --------- 監聽鍵盤 ---------
document.addEventListener("keydown", e => {
    if (e.key === "ArrowLeft") cat.x -= cat.speed;
    if (e.key === "ArrowRight") cat.x += cat.speed;

    // 防止移出螢幕
    cat.x = Math.max(0, Math.min(canvas.width - cat.size, cat.x));
});

// --------- 遊戲主迴圈 ---------
function gameLoop() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    frameCount++;
    if (frameCount % 40 === 0) spawnFood();

    // 落下速度隨時間變快
    fallSpeed += 0.001;

    // 畫小貓
    ctx.fillStyle = "#444";
    ctx.beginPath();
    ctx.arc(cat.x + cat.size / 2, cat.y + cat.size / 2, cat.size / 2, 0, Math.PI * 2);
    ctx.fill();

    // 更新食物
    for (let i = foods.length - 1; i >= 0; i--) {
        let f = foods[i];
        f.y += f.speed;

        // 畫食物
        ctx.fillStyle = f.good ? "#ff6eb7" : "#555";
        ctx.fillRect(f.x, f.y, f.size, f.size);

        // 碰撞檢查
        if (
            f.y + f.size >= cat.y &&
            f.x + f.size >= cat.x &&
            f.x <= cat.x + cat.size
        ) {
            if (f.good) {
                score += 100;
            } else {
                life--;
            }
            foods.splice(i, 1);
        }

        // 掉出螢幕移除
        if (f.y > canvas.height) foods.splice(i, 1);
    }

    // 更新 UI
    document.getElementById("ui").innerText = `分數：${score}　|　生命：${life}`;

    // 遊戲結束
    if (life <= 0) {
        ctx.fillStyle = "rgba(0,0,0,0.5)";
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = "#fff";
        ctx.font = "48px Arial";
        ctx.fillText("Game Over", canvas.width / 2 - 120, canvas.height / 2);
        return;
    }

    requestAnimationFrame(gameLoop);
}

gameLoop();
</script>

</body>
</html>
